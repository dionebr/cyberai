<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CyberAI Offensive Suite</title>
    <link rel="stylesheet" href="/static/css/main.css" />
    <link rel="stylesheet" href="/static/css/terminal.css" />
    <!-- DEV ONLY: Tailwind CDN. Em produção, use build local -->
        <!-- Fonts: Inter (sans) e JetBrains Mono (mono) -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            sans: ["Inter","ui-sans-serif","system-ui","-apple-system","Segoe UI","Roboto","Ubuntu","Cantarell","Noto Sans","Helvetica Neue","Arial","sans-serif"],
                            mono: ["JetBrains Mono","ui-monospace","SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New","monospace"]
                        }
                    }
                }
            }
        </script>
</head>
<body class="bg-gray-950 text-gray-100 min-h-screen flex flex-col font-sans">
            <header class="p-4 border-b border-gray-800">
                    <div class="max-w-6xl mx-auto flex items-center">
                        <h1 class="text-2xl font-extrabold tracking-tight text-green-400">CYBERAI</h1>
                    </div>
            </header>

    <main class="max-w-6xl mx-auto px-4 py-5 flex-1">
        <!-- Grid de módulos -->
    <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-0" id="modules">
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-green-600" onclick="showModule('recon')">
                <h3 class="text-green-400 font-semibold mb-1">Reconhecimento</h3>
                <p class="text-xs text-gray-400">Nmap, subdomínios, tecnologias e diretórios.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-blue-600" onclick="showModule('payloads')">
                <h3 class="text-blue-400 font-semibold mb-1">Payloads</h3>
                <p class="text-xs text-gray-400">Reverse shells, EDR bypass, stagers e crypters.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-purple-600" onclick="showModule('binarios')">
                <h3 class="text-purple-400 font-semibold mb-1">Análise de Binários</h3>
                <p class="text-xs text-gray-400">RE, malware, shellcode e debugging.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-red-600" onclick="showModule('exploit')">
                <h3 class="text-red-400 font-semibold mb-1">Exploração</h3>
                <p class="text-xs text-gray-400">Geração e teste de exploits e CVEs.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-yellow-600" onclick="showModule('post')">
                <h3 class="text-yellow-400 font-semibold mb-1">Pós-Exploração</h3>
                <p class="text-xs text-gray-400">Persistência, movimento lateral e coleta.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-pink-600" onclick="showModule('treinamento')">
                <h3 class="text-pink-400 font-semibold mb-1">Treinamento</h3>
                <p class="text-xs text-gray-400">CTFs, labs e guided learning.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-cyan-600" onclick="showModule('relatorios')">
                <h3 class="text-cyan-400 font-semibold mb-1">Relatórios</h3>
                <p class="text-xs text-gray-400">Templates, evidências e exportação.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-orange-600" onclick="showModule('gestao')">
                <h3 class="text-orange-400 font-semibold mb-1">Gestão</h3>
                <p class="text-xs text-gray-400">Alvos, escopo, métricas e tarefas.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-lime-600" onclick="showModule('ferramentas')">
                <h3 class="text-lime-400 font-semibold mb-1">Dev Tools</h3>
                <p class="text-xs text-gray-400">Templates e assistentes para código.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-teal-600" onclick="showModule('intelligence')">
                <h3 class="text-teal-400 font-semibold mb-1">Threat Intel</h3>
                <p class="text-xs text-gray-400">Feeds, TTPs e alertas.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-fuchsia-600" onclick="showModule('lab')">
                <h3 class="text-fuchsia-400 font-semibold mb-1">Laboratório</h3>
                <p class="text-xs text-gray-400">Ambiente seguro para testes.</p>
            </button>
            <button class="bg-gray-900 border border-gray-800 rounded p-4 text-left hover:border-gray-600" onclick="showModule('community')">
                <h3 class="text-gray-300 font-semibold mb-1">Comunidade</h3>
                <p class="text-xs text-gray-400">Plugins e colaboração.</p>
            </button>
        </section>

        <!-- Área dinâmica de conteúdo -->
        <section id="module-content" class="mt-6"></section>
    </main>

            <!-- Botão flutuante do chat -->
        <button
            aria-label="Abrir chat"
            title="Abrir chat"
                onclick="toggleChatPanel()"
            class="fixed right-5 bottom-5 h-14 w-14 rounded-full bg-gray-900/90 text-white backdrop-blur ring-1 ring-green-500/40 hover:ring-green-400 hover:bg-gray-900 transition shadow-xl shadow-green-900/20 flex items-center justify-center"
        >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-7 w-7">
                <path d="M7.5 8.25h9a2.25 2.25 0 0 1 2.25 2.25v3a2.25 2.25 0 0 1-2.25 2.25h-3.586a1.5 1.5 0 0 0-1.06.44l-1.939 1.939A.75.75 0 0 1 9 17.94V15.75H7.5A2.25 2.25 0 0 1 5.25 13.5v-3A2.25 2.25 0 0 1 7.5 8.25z" />
            </svg>
        </button>

        <!-- Painel de chat abaixo dos cards -->
            <section id="chatPanel" class="fixed z-40 left-1/2 -translate-x-1/2 bottom-[calc(5rem-0.75cm)] w-[calc(100%-1rem)] max-w-7xl hidden">
                <div class="relative mx-auto w-full pointer-events-auto">
                <!-- Cabeçalho do painel -->
                <div class="text-center mb-2">
                    <div class="mx-auto h-10 w-10 rounded-2xl bg-gradient-to-br from-green-500/20 to-emerald-500/10 border border-green-400/30 flex items-center justify-center shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5 text-green-300">
                            <path d="M7.5 8.25h9a2.25 2.25 0 0 1 2.25 2.25v3a2.25 2.25 0 0 1-2.25 2.25h-3.586a1.5 1.5 0 0 0-1.06.44l-1.939 1.939A.75.75 0 0 1 9 17.94V15.75H7.5A2.25 2.25 0 0 1 5.25 13.5v-3A2.25 2.25 0 0 1 7.5 8.25z" />
                        </svg>
                    </div>
                    <h2 class="mt-2 text-2xl font-extrabold tracking-tight text-gray-100">Posso ajudar em algo?</h2>
                    <p class="text-[13px] text-gray-400">Pronto para auxiliar em exploração, payloads, enumeração e recomendações técnicas.</p>
                </div>

                <!-- Container "glass" do chat -->
                <div class="rounded-2xl border border-white/10 bg-gradient-to-b from-gray-900/80 to-gray-950/90 backdrop-blur shadow-2xl overflow-hidden">
                    <!-- Mensagens -->
                <div id="chatMessages" class="h-48 overflow-y-auto p-4 space-y-3 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gray-800/40 via-gray-900/40 to-gray-950/60"></div>

                    <!-- Ações rápidas -->
                    <div class="px-4 pt-3 pb-2 flex flex-wrap gap-2 text-xs">
                        <button class="px-3 py-1 rounded-full bg-green-600/20 text-green-300 hover:bg-green-600/30 border border-green-500/20" onclick="insertPayload('nmap')">Nmap agressivo</button>
                        <button class="px-3 py-1 rounded-full bg-blue-600/20 text-blue-300 hover:bg-blue-600/30 border border-blue-500/20" onclick="insertPayload('reverse_shell')">Reverse Shell</button>
                        <button class="px-3 py-1 rounded-full bg-amber-600/20 text-amber-300 hover:bg-amber-600/30 border border-amber-500/20" onclick="insertPayload('privesc')">PrivEsc</button>
                        <button class="px-3 py-1 rounded-full bg-cyan-600/20 text-cyan-300 hover:bg-cyan-600/30 border border-cyan-500/20" onclick="insertPayload('web_enum')">Web Enum</button>
                    </div>

                    <!-- Input estilo "pill" -->
                    <div class="p-4">
                          <div class="flex items-center gap-2 rounded-2xl bg-gray-950/90 border border-white/10 px-3 py-2">
                            <button class="p-2 rounded-xl text-gray-400 hover:text-gray-200 hover:bg-white/5" title="Comandos">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                                    <path d="M8.25 6.75 3 12l5.25 5.25m12.75-10.5-5.25 5.25 5.25 5.25" />
                                </svg>
                            </button>
                            <textarea id="userInput" rows="1" class="flex-1 resize-none bg-transparent outline-none text-sm placeholder:text-gray-500 text-gray-200" placeholder="Descreva o que precisa… (ex: gerar payload reverso bash para 10.10.11.5:4444)"></textarea>
                            <div class="flex items-center gap-1">
                                <button class="p-2 rounded-xl text-gray-400 hover:text-gray-200 hover:bg-white/5" title="Opções">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5"><path d="M6.75 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm6.75 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm6.75 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/></svg>
                                </button>
                                <button class="px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm font-medium" onclick="sendMessage()">Enviar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="w-full text-center py-4 mt-auto bg-gray-900 border-t border-gray-800 text-gray-400 text-xs">
        <div class="flex flex-col md:flex-row items-center justify-center gap-2">
            <span>Desenvolvido por <span class="text-green-400 font-bold">Dione Lima</span></span>
            <span>|</span>
            <a href="https://www.buymeacoffee.com/dionelima" target="_blank" class="text-yellow-400 hover:underline">Doe um café ☕</a>
            <span>|</span>
            <span>CyberAI Offensive Suite © 2025</span>
        </div>
    </footer>

    <script>
    // Config
    // Autodetecta: quando servido via HTTP(S), usa /api (Nginx proxy); se abrir via file://, usa localhost:8000
    const API_BASE = (location.origin.startsWith('http')) ? '/api' : 'http://localhost:8000';
    const PAYLOADS = {
        nmap: 'Gere um comando Nmap agressivo com detecção de versão e scripts. Alvo: 10.10.11.123',
        reverse_shell: 'Crie reverse shells em Bash, Python, PowerShell e Node para 10.10.11.123:4444',
        privesc: 'Checklist de PrivEsc Linux com comandos práticos e resumo dos achados',
        web_enum: 'Script de enumeração web (subdomínios, diretórios e arquivos sensíveis)'
    };

    // UI helpers
    function addMessage(sender, text) {
        const wrap = document.createElement('div');
        wrap.className = `p-2 rounded ${sender==='user' ? 'bg-blue-900/50' : 'bg-gray-800'}`;
        wrap.innerHTML = `<strong class="${sender==='user' ? 'text-blue-300' : 'text-green-300'}">${sender==='user' ? 'Você' : 'CyberAI'}:</strong> <span class="whitespace-pre-wrap">${text}</span>`;
        const box = document.getElementById('chatMessages');
        box.appendChild(wrap);
        box.scrollTop = box.scrollHeight;
    }

    function insertPayload(type) {
        document.getElementById('userInput').value = PAYLOADS[type] || '';
    }

        // Painel de chat (toggle)
            function toggleChatPanel() {
                const panel = document.getElementById('chatPanel');
                const wasHidden = panel.classList.contains('hidden');
                panel.classList.toggle('hidden');
                // Congela/descongela rolagem do body para manter página estática
                document.body.classList.toggle('overflow-hidden', wasHidden);
                if (wasHidden) setTimeout(() => document.getElementById('userInput')?.focus(), 150);
            }

    // Router de módulos (placeholder)
    function showModule(module) {
        const content = document.getElementById('module-content');
        const blocks = {
            recon: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-green-400 text-xl font-bold mb-2">Módulo de Reconhecimento</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Nmap custom</li>
                        <li>Subdomínios (amass/subfinder)</li>
                        <li>Wappalyzer-like</li>
                        <li>Gobuster/dirbuster</li>
                    </ul>
                    <button class="bg-green-600 hover:bg-green-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            payloads: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-blue-400 text-xl font-bold mb-2">Payloads Avançados</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Reverse shells polimórficos</li>
                        <li>Bypass AV/EDR</li>
                        <li>Stagers para C2</li>
                    </ul>
                    <button class="bg-blue-600 hover:bg-blue-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            binarios: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-purple-400 text-xl font-bold mb-2">Análise de Binários</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>radare2/Ghidra</li>
                        <li>Malware/IOC</li>
                        <li>Shellcode</li>
                    </ul>
                    <button class="bg-purple-600 hover:bg-purple-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            exploit: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-red-400 text-xl font-bold mb-2">Exploração Automatizada</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Sugestão de vulnerabilidades</li>
                        <li>Geração de exploits</li>
                        <li>Integração com ferramentas</li>
                    </ul>
                    <button class="bg-red-600 hover:bg-red-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            post: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-yellow-400 text-xl font-bold mb-2">Pós-Exploração</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Persistência</li>
                        <li>Lateral movement</li>
                        <li>Dumping de credenciais</li>
                    </ul>
                    <button class="bg-yellow-600 hover:bg-yellow-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            treinamento: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-pink-400 text-xl font-bold mb-2">Treinamento</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>CTFs</li>
                        <li>Labs</li>
                        <li>Guided learning</li>
                    </ul>
                    <button class="bg-pink-600 hover:bg-pink-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            relatorios: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-cyan-400 text-xl font-bold mb-2">Relatórios</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Templates</li>
                        <li>Exportação</li>
                        <li>Evidências</li>
                    </ul>
                    <button class="bg-cyan-600 hover:bg-cyan-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            gestao: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-orange-400 text-xl font-bold mb-2">Gestão</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Alvos e escopo</li>
                        <li>Métricas</li>
                        <li>Tarefas</li>
                    </ul>
                    <button class="bg-orange-600 hover:bg-orange-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            ferramentas: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-lime-400 text-xl font-bold mb-2">Dev Tools</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Templates</li>
                        <li>Assistentes</li>
                        <li>APIs</li>
                    </ul>
                    <button class="bg-lime-600 hover:bg-lime-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            intelligence: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-teal-400 text-xl font-bold mb-2">Threat Intelligence</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Feeds e CVEs</li>
                        <li>TTPs</li>
                        <li>Alertas</li>
                    </ul>
                    <button class="bg-teal-600 hover:bg-teal-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`,
            lab: `
                <div class="bg-gray-900 rounded p-4 border border-gray-800">
                    <h2 class="text-fuchsia-400 text-xl font-bold mb-2">Laboratório Virtual</h2>
                    <ul class="list-disc ml-6 text-gray-300 text-sm mb-3">
                        <li>Ambientes isolados</li>
                        <li>Máquinas vulneráveis</li>
                        <li>Sandbox</li>
                    </ul>
                    <button class="bg-fuchsia-600 hover:bg-fuchsia-700 rounded px-3 py-1">Abrir Módulo</button>
                </div>`
        };
        content.innerHTML = blocks[module] || '';
    }

    // Chat simple
    async function sendMessage() {
        const message = document.getElementById('userInput').value.trim();
        if (!message) return;
        addMessage('user', message);
        document.getElementById('userInput').value = '';

        try {
            const res = await fetch(`${API_BASE}/generate`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ prompt: message, technique: '', context: '', target: '' })
            });
            if (!res.ok) {
                let detail = '';
                try { const err = await res.json(); detail = err.detail || ''; } catch {}
                if (res.status === 503) {
                    addMessage('bot', 'Modelo indisponível no servidor. Baixe o modelo GGUF e reinicie a API.');
                } else {
                    addMessage('bot', `Erro da API (${res.status}). ${detail}`.trim());
                }
                return;
            }
            const data = await res.json();
            addMessage('bot', data.response || 'Sem resposta.');
        } catch (err) {
            addMessage('bot', 'Erro ao comunicar com a API.');
            console.error(err);
        }
    }

            // Enviar com Enter (Shift+Enter = nova linha)
            document.addEventListener('keydown', (e) => {
                const ta = document.getElementById('userInput');
                if (!ta) return;
                if (document.activeElement === ta && e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
    </script>
</body>
</html>